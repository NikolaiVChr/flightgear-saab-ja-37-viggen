<?xml version="1.0"?>

<system name="indicators">

    <!-- JA-37Di pilots Manual page 589 and forward. Also bits of info scattered all over the document.
         JA-37C pilots Manual page 572 and forward. Also bits of info scattered all over the document.

         [not implemented] When a blinking light warning also induces a master warning, and that warning is acknowledged, then the blinking turns to steady.

         When lamptest button is pressed all light go on and blinking lights will blink. Master-warning also goes on.
     -->

    <channel execrate="4" name="Left indicator panel logic">


        <!-- Swedish: BRAND (sound, blinking)
        -->

        <fcs_function name="systems/indicators/fire-primary">
            <function>
                <eq>
                    <property>/engines/engine[0]/fire/serviceable</property>
                    <value>0</value>
                </eq>
            </function>
        </fcs_function>

        <switch name="systems/indicators/fire">
            <default value="0"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
              systems/indicators/fire-primary == 1
              /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>


        <!-- Swedish: BRÄ UPPF (blinking, suppression of blinking if secondary from Hydr-1)
        -->

        <fcs_function name="systems/indicators/fuel-flow-secondary">
            <function>
                <and>
                    <p>systems/indicators/hydr-1-primary</p>
                    <gt>
                        <property>instruments/fuel/ratio</property>
                        <value>0.40</value>
                    </gt>
                </and>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/fuel-flow-primary">
            <function>
                    <and>
                        <gt>
                            <property>instruments/fuel/ratio</property>
                            <value>0.43</value>
                        </gt>
                        <eq>
                            <property>/gear/gear[0]/position-norm</property>
                            <value>1</value>
                        </eq>
                        <eq>
                            <property>systems/fuel/pneumatic-low-pressure</property>
                            <value>0</value>
                        </eq>
                    </and>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/fuel-flow-primary-2">
            <function>
                <and>
                    <eq>
                        <property>systems/fuel/fuel-flow/serviceable</property>
                        <value>0</value>
                    </eq>
                    <gt>
                        <property>instruments/fuel/ratio</property>
                        <value>0.43</value>
                    </gt>
                    <gt>
                        <product>
                            <property>/consumables/fuel/tank[3]/level-gal_us</property>
                            <v>3.785</v>
                        </product>
                        <value>130</value><!-- liters -->
                    </gt>
                    <or>
                        <nq>
                            <property>/gear/gear[0]/wow</property>
                            <value>1</value>
                        </nq>
                        <p>systems/indicators/hydr-1-primary</p>
                    </or>                
                </and>
            </function>
        </fcs_function>

        <switch name="systems/indicators/fuel-flow-primary-2-time">
            <default value="sim-time-sec"/>
            <test logic="OR" value="systems/indicators/fuel-flow-primary-2-time">
                systems/indicators/fuel-flow-primary-2 == 1
            </test>
        </switch>

        <fcs_function name="systems/indicators/fuel-flow-primary-2-time-blinking">
            <function>
                <sum>
                    <p>systems/indicators/fuel-flow-primary-2-time</p>
                    <v>10</v>
                </sum>
            </function>
        </fcs_function>

        <switch name="systems/indicators/fuel-flow">
            <default value="systems/indicators/fuel-flow-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
              systems/indicators/fuel-flow-primary == 1
              sim-time-sec gt systems/indicators/fuel-flow-primary-2-time-blinking
              /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>


        <!-- Swedish: X-TANK BRÄ (steady)

        At the end of manual it says steady, in middle of manual it says it can also blink.
        Blinking makes most sense, as it will show difference between not enough pressure
        from pneumatic pump or if malfunction prevent fuel from being used.


        -->

        <fcs_function name="systems/indicators/xtank-secondary">
            <function>
                <and>
                    <eq>
                        <property>/consumables/fuel/tank[8]/jettisoned</property>
                        <value>0</value>
                    </eq>
                    <gt>
                        <property>/consumables/fuel/tank[8]/level-gal_us</property>
                        <value>45</value>
                    </gt>
                    <lt>
                        <p>propulsion/engine[0]/n2</p>
                        <v>70</v>
                    </lt>
                </and>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/xtank-primary">
            <function>
                <and>
                    <eq>
                        <property>/consumables/fuel/tank[8]/jettisoned</property>
                        <value>0</value>
                    </eq>
                    <gt>
                        <property>/consumables/fuel/tank[8]/level-gal_us</property>
                        <value>45</value>
                    </gt>
                    <eq>
                        <p>systems/fuel/pneumatics/serviceable</p>
                        <v>0</v>
                    </eq>
                </and>
            </function>
        </fcs_function>

        <switch name="systems/indicators/xtank">
            <default value="systems/indicators/xtank-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
              systems/indicators/xtank-primary == 1
              /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>
    

        <!-- Swedish: TANKPUMP (blinking, suppression of blinking if secondary from Electrical)
        -->

        <fcs_function name="systems/indicators/fuel-pump-secondary">
            <function>
                    <eq>
                        <property>systems/indicators/electrical-primary</property>
                        <value>1</value>
                    </eq>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/fuel-pump-primary">
            <function>
                    <eq>
                        <property>systems/fuel/fuel-pumps/serviceable</property>
                        <value>0</value>
                    </eq>
            </function>
        </fcs_function>

        <switch name="systems/indicators/fuel-pump">
            <default value="systems/indicators/fuel-pump-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
              systems/indicators/fuel-pump-primary == 1
              /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>


        <!-- Swedish: LANDSTÄLL (blinking/steady, sound)
        -->

        <fcs_function name="systems/indicators/gears-primary">
            <function>
                <and>
                    <or>
                        <!--<equals>
                            <property>gear/serviceable</property>
                            <value>0</value>
                        </equals>-->
                        <eq>
                            <property>gear/unit[0]/z-position</property>
                            <value>0.001</value>
                        </eq>
                        <eq>
                            <property>gear/unit[1]/z-position</property>
                            <value>0.001</value>
                        </eq>
                        <eq>
                            <property>gear/unit[2]/z-position</property>
                            <value>0.001</value>
                        </eq>
                        <nq>
                            <property>/gear/gear[0]/position-norm</property>
                            <value>1</value>
                        </nq>
                    </or>
                    <lt>
                        <property>propulsion/engine[0]/n2</property>
                        <value>87</value>
                    </lt>
                    <lt>
                        <property>/instrumentation/airspeed-indicator/indicated-speed-kt</property>
                        <value>202.5</value>
                    </lt>
                    <lt>
                        <property>/instrumentation/altimeter/indicated-altitude-meter</property>
                        <value>500</value>
                    </lt>
                </and>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/gears-secondary">
            <function>
                <or>
                    <and>
                        <nq>
                            <property>/gear/gear[0]/position-norm</property>
                            <value>1</value>
                        </nq>
                        <nq>
                            <property>/gear/gear[0]/position-norm</property>
                            <value>0</value>
                        </nq>
                    </and>
                    <and>
                        <eq>
                            <property>gear/gear-cmd-norm</property>
                            <value>0</value>
                        </eq>
                        <eq>
                            <property>/gear/gear[1]/wow</property>
                            <value>1</value>
                        </eq>
                    </and>
                    <and>
                        <or>
                            <eq>
                                <property>gear/unit[1]/z-position</property>
                                <value>0.001</value>
                            </eq>
                            <eq>
                                <property>gear/unit[2]/z-position</property>
                                <value>0.001</value>
                            </eq>
                            <eq>
                                <property>gear/unit[0]/z-position</property>
                                <value>0.001</value>
                            </eq>
                        </or>
                        <eq>
                            <property>/gear/gear[0]/position-norm</property>
                            <value>1</value>
                        </eq>
                    </and>
                </or>
            </function>
        </fcs_function>

        <switch name="systems/indicators/gears-time-steady">
            <default value="sim-time-sec"/>
            <test logic="OR" value="systems/indicators/gears-time-steady">
                systems/indicators/gears-secondary == 1
            </test>
        </switch>

        <fcs_function name="systems/indicators/gears-time-blinking">
            <function>
                <sum>
                    <p>systems/indicators/gears-time-steady</p>
                    <v>10</v>
                </sum>
            </function>
        </fcs_function>

        <switch name="systems/indicators/gears">
            <default value="systems/indicators/gears-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/gears-primary == 1
                sim-time-sec gt systems/indicators/gears-time-blinking
            </test>
        </switch>

       <!-- Swedish: FÖRV FÖRBJ (blinking)
        -->

        <fcs_function name="systems/indicators/forward-thrust-primary">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/hydraulics/system1/pressure</property>
                            <value>0</value>
                        </eq>
                        <lt>
                            <property>/ja37/elec/dc-bus-main-volt</property>
                            <value>20</value>
                        </lt>
                        <eq>
                            <property>/controls/engines/engine/reverse-system/serviceable</property>
                            <value>0</value>
                        </eq>
                    </or>
                    <eq>
                        <property>/engines/engine/is-reversed</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/forward-thrust">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/indicators/forward-thrust-primary</property>
                            <value>1</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <p>/ja37/blink/four-Hz/state</p>             
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: NOSSTÄLL (steady)
        -->

        <fcs_function name="systems/indicators/gear-nose">
            <function>
                <or>
                    <and>
                        <eq>
                            <property>/gear/gear[0]/position-norm</property>
                            <value>1</value>
                        </eq>
                        <nq>
                            <property>gear/unit[0]/z-position</property>
                            <value>0.001</value>
                        </nq>
                    </and>
                    <property>/controls/lighting/test-indicator-panels</property>
                </or>
            </function>
        </fcs_function>


        <!-- Swedish: V STÄLL (steady)
        -->

        <fcs_function name="systems/indicators/gear-left">
            <function>
                <or>
                    <and>
                        <eq>
                            <property>/gear/gear[1]/position-norm</property>
                            <value>1</value>
                        </eq>
                        <nq>
                            <property>gear/unit[1]/z-position</property>
                            <value>0.001</value>
                        </nq>
                    </and>
                    <property>/controls/lighting/test-indicator-panels</property>
                </or>
            </function>
        </fcs_function>


        <!-- Swedish: H STÄLL (steady)
        -->

        <fcs_function name="systems/indicators/gear-right">
            <function>
                <or>
                    <and>
                        <eq>
                            <property>/gear/gear[2]/position-norm</property>
                            <value>1</value>
                        </eq>
                        <nq>
                            <property>gear/unit[2]/z-position</property>
                            <value>0.001</value>
                        </nq>
                    </and>
                    <property>/controls/lighting/test-indicator-panels</property>
                </or>
            </function>
        </fcs_function>

        <!-- Swedish: LUFTBROMS (steady)
        -->

        <fcs_function name="systems/indicators/speedbrake-primary">
            <function>
                <lt>
                    <property>/sim/failure-manager/controls/flight/speedbrake/serviceable</property>
                    <value>1</value>
                </lt>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/speedbrake-secondary">
            <function>
                <gt>
                    <property>fcs/speedbrake-pos-norm</property>
                    <value>0</value>
                </gt>
            </function>
        </fcs_function>

        <switch name="systems/indicators/speedbrake">
            <default value="systems/indicators/speedbrake-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/speedbrake-primary == 1
            </test>
        </switch>
                
        <!-- Swedish: ELFÖRS (blinking)
        -->

        <fcs_function name="systems/indicators/electrical-primary">
            <function>
                <or>
                    <eq>
                        <property>/systems/electrical/serviceable</property>
                        <value>0</value>
                    </eq>
                    <lt>
                        <property>systems/electrical/generator-running-norm</property>
                        <value>0.99</value>
                    </lt>
                    <lt>
                        <property>/ja37/elec/dc-bus-battery-3-volt</property>
                        <value>20</value>
                    </lt>
                    <and>
                        <or>
                            <eq>
                                <property>/gear/gear[1]/position-norm</property>
                                <value>1</value>
                            </eq>
                            <eq>
                                <property>/gear/gear[2]/position-norm</property>
                                <value>1</value>
                            </eq>
                        </or>
                        <eq>
                            <property>systems/electrical/generator-reserve-deploy-emergency-cmd</property>
                            <value>1</value>
                        </eq>
                        <eq>
                            <property>/systems/electrical/serviceable</property>
                            <value>0</value>
                        </eq>
                    </and>
                </or>
            </function>
        </fcs_function>
        
        <switch name="systems/indicators/electrical">
            <default value="0"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/electrical-primary == 1
            </test>
        </switch>


        <!-- Swedish: ELRESERV (blinking)
        -->

        <fcs_function name="systems/indicators/electrical-reserve-primary">
            <function>
                <or>
                    <and>
                        <eq>
                            <property>systems/electrical/generator-reserve-supplying</property>
                            <value>0</value>
                        </eq>
                        <eq>
                            <property>systems/electrical/generator-running-norm</property>
                            <value>0</value>
                        </eq>
                    </and>
                    <and>
                        <eq>
                            <property>systems/electrical/generator-reserve-deploy-emergency-cmd</property><!-- should really be RAT extended but dont make sense.. -->
                            <value>1</value>
                        </eq>
                        <eq>
                            <property>systems/electrical/generator-running-norm</property>
                            <value>1</value>
                        </eq>
                    </and>
                    <and>
                        <lt>
                            <property>systems/electrical/generator-reserve-pos-norm</property>
                            <value>1</value>
                        </lt>
                        <eq>
                            <property>propulsion/starter_cmd</property>
                            <value>1</value>
                        </eq>
                    </and>
                    <and>
                        <eq>
                            <property>systems/electrical/generator-reserve-supplying</property>
                            <value>0</value>
                        </eq>
                        <eq>
                            <property>/gear/gear[0]/wow</property>
                            <value>0</value>
                        </eq>
                        <eq>
                            <property>/gear/gear[0]/position-norm</property>
                            <value>1</value>
                        </eq>                        
                        <eq>
                            <property>propulsion/starter_cmd</property>
                            <value>1</value>
                        </eq>
                    </and>
                </or>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/electrical-reserve">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/indicators/electrical-reserve-primary</property>
                            <value>1</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>



        <!-- Swedish: HYDR-TR2 (blinking)
        -->

        <fcs_function name="systems/indicators/hydr-2">
            <function>
                <and>
                    <or>                    
                        <eq>
                            <property>systems/hydraulics/system2/pressure-main</property>
                            <value>0</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and> 
            </function>
        </fcs_function>



        <!-- Swedish: HYDR-TR1 (blinking, sound)
        -->
        <fcs_function name="systems/indicators/hydr-1-primary">
            <function>
                <eq>
                    <property>systems/hydraulics/system1/pressure</property>
                    <value>0</value>
                </eq>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/hydr-1">
            <function>
                <and>
                    <or>
                        <property>systems/indicators/hydr-1-primary</property>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: AFK (blinking/steady, sound)
        -->

        <switch name="systems/indicators/auto-throttle-secondary">
            <default value="autoflight/athr-disengaged-normal"/>
        </switch>

        <switch name="systems/indicators/auto-throttle-primary">
            <default value="autoflight/athr-disengaged-failure"/>
            <test logic="AND" value="1">
                autoflight/ac-bus-main-bool-timer-2s eq 0
                autoflight/athr-pos eq 1
                autoflight/athr-disengaged-normal eq 0
            </test>
        </switch>

        <switch name="systems/indicators/auto-throttle">
            <default value="systems/indicators/auto-throttle-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/auto-throttle-primary == 1
            </test>
        </switch>


        <!-- Swedish: EJ REV (blinking)
        -->

        <fcs_function name="systems/indicators/no-reverse-tertiary">
            <function>
                <and>
                    <or>
                        <nq>
                            <property>/gear/gear[0]/position-norm</property>
                            <value>0</value>
                        </nq>
                        <lt>
                            <property>velocities/mach</property>
                            <value>0.64</value>
                        </lt>
                    </or>
                    <nq>
                        <property>/ja37/systems/tertiary-opening</property>
                        <value>1</value>
                    </nq>
                </and>
            </function>
        </fcs_function>

        <switch name="systems/indicators/no-reverse-tertiary-time">
            <default value="sim-time-sec"/>
            <test logic="OR" value="systems/indicators/no-reverse-tertiary-time">
                systems/indicators/no-reverse-tertiary == 1
            </test>
        </switch>

        <fcs_function name="systems/indicators/no-reverse-tertiary-times-up">
            <function>
                <sum>
                    <p>systems/indicators/no-reverse-tertiary-time</p>
                    <v>12</v><!-- manual say 10, but have to give it time to open -->
                </sum>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/no-reverse-primary">
            <function>
                <or>
                    <and>
                        <or>
                            <eq>
                                <property>systems/hydraulics/system1/pressure</property>
                                <value>0</value>
                            </eq>
                            <lt>
                                <property>/ja37/elec/dc-bus-main-volt</property>
                                <value>20</value>
                            </lt>
                            <eq>
                                <property>/controls/engines/engine/reverse-system/serviceable</property>
                                <value>0</value>
                            </eq>
                        </or>
                        <eq>
                            <property>/engines/engine/is-reversed</property>
                            <value>0</value>
                        </eq>
                    </and>
                    <lt>
                        <property>systems/indicators/no-reverse-tertiary-times-up</property>
                        <property>sim-time-sec</property>
                    </lt>
                </or>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/no-reverse">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/indicators/no-reverse-primary</property>
                            <value>1</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: HYDRRESERV (blinking)
        -->

        <fcs_function name="systems/indicators/hydr-reserve">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/hydraulics/system2/pressure-reserve</property>
                            <value>0</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: OLJETRYCK (blinking, sound)
        -->

        <fcs_function name="systems/indicators/oil-pressure-primary">
            <function>
                <or>
                    <lt>
                        <property>propulsion/engine/oil-pressure-psi</property>
                        <value>15.0</value>
                    </lt>
                    <gt>
                        <property>systems/flight/oil/pressure-drop-norm</property>
                        <value>0.5</value>
                    </gt>
                </or>
            </function>
        </fcs_function>
        
        <fcs_function name="systems/indicators/oil-pressure-secondary">
            <function>
                <or>
                    <lt>
                        <property>propulsion/engine/oil-pressure-psi</property>
                        <value>20.0</value>
                    </lt>
                    <gt>
                        <property>systems/flight/oil/pressure-drop-norm</property>
                        <value>0.20</value>
                    </gt>
                </or>
            </function>
        </fcs_function>

        <switch name="systems/indicators/oil-pressure">
            <default value="systems/indicators/oil-pressure-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                systems/indicators/oil-pressure-primary == 1
                /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>


        <!-- Swedish: OLJETEMP (blinking)
        -->

        <fcs_function name="systems/indicators/oil-temperature">
            <function>
                <and>
                    <property>/controls/lighting/test-indicator-panels</property>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>

    </channel>





    

    <channel execrate="4" name="Right indicator panel logic">

        <!-- Swedish: SPAK (blinking, sound)

            This is for the flightstick assist systems, like roll and pitch dampers etc.
            Blinking (SPAK,ALT,HÖJD) suppresed by hydr-1 and primary data.

            Properties systems/indicators/{flightstick,auto-attitude,auto-altitude}-level
            are computed in Nasal/autoflight.nas. They are state machines:
            2: blinking, triggered by A/P downgrade
            1: steady, after master warning acknowledgement
            0: off, after master warning acknowledgement, then pressing any A/P button
        -->

        <switch name="systems/indicators/flightstick-secondary">
            <default value="0"/>
            <test logic="OR" value="1">
                systems/indicators/flightstick-level gt 0
                /ja37/elec/ac-bus-main-bool == 0
            </test>
        </switch>

        <switch name="systems/indicators/flightstick-primary">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/primary-data-primary == 1
                systems/indicators/hydr-1-primary == 1
            </test>
            <test value="1">
                systems/indicators/flightstick-level == 2
            </test>
        </switch>

        <switch name="systems/indicators/flightstick">
            <default value="systems/indicators/flightstick-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/flightstick-primary == 1
            </test>
        </switch>

        <!-- Swedish: ATT  (blinking, sound)
        -->
        <switch name="systems/indicators/auto-attitude-secondary">
            <default value="0"/>
            <test logic="OR" value="1">
                systems/indicators/auto-attitude-level gt 0
            </test>
        </switch>

        <switch name="systems/indicators/auto-attitude-primary">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/primary-data-primary == 1
                systems/indicators/hydr-1-primary == 1
            </test>
            <test value="1">
                systems/indicators/auto-attitude-level == 2
            </test>
        </switch>

        <switch name="systems/indicators/auto-attitude">
            <default value="systems/indicators/auto-attitude-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/auto-attitude-primary == 1
            </test>
        </switch>

        <!-- Swedish: HOJD  (blinking, sound)
        -->
        <switch name="systems/indicators/auto-altitude-secondary">
            <default value="0"/>
            <test logic="OR" value="1">
                systems/indicators/auto-altitude-level gt 0
            </test>
        </switch>

        <switch name="systems/indicators/auto-altitude-primary">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/primary-data-primary == 1
                systems/indicators/hydr-1-primary == 1
            </test>
            <test value="1">
                systems/indicators/auto-altitude-level == 2
            </test>
        </switch>

        <switch name="systems/indicators/auto-altitude">
            <default value="systems/indicators/auto-altitude-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/auto-altitude-primary == 1
            </test>
        </switch>


        <!-- Swedish: BRAND GTS  (blinking, sound)
        -->
        
        <fcs_function name="systems/indicators/fire-in-starter">
            <function>
                <and>
                    <property>/controls/lighting/test-indicator-panels</property>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: TIPPVÄXEL (blinking, sound)

            not authentic implemented
        -->
        
        <fcs_function name="systems/indicators/pitch-gearing-primary">
            <function>
                <eq>
                    <property>fcs/elevator/gearing-enable</property>
                    <value>0</value>
                </eq>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/pitch-gearing">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/indicators/pitch-gearing-primary</property>
                            <value>1</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: KABINHÖJD (blinking)
        -->
        
        <fcs_function name="systems/indicators/cabin-pressure-primary">
            <function>
                <lt>
                    <property>systems/flight/cabin-pressure-kpm2</property>
                    <value>0.15</value>
                </lt>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/cabin-pressure">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/indicators/cabin-pressure-primary</property>
                            <value>1</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: HUV o STOL (blinking)
        -->

        <fcs_function name="systems/indicators/canopy-and-seat-primary">
            <function>
                <or>
                    <eq>
                        <property>fcs/canopy/has-power</property>
                        <value>0</value>
                    </eq>
                    <and>
                        <nq>
                            <property>/canopy/position-norm</property>
                            <value>0</value>
                        </nq>
                        <or>
                            <nq>
                                <property>/gear/gear[0]/wow</property>
                                <value>1</value>
                            </nq>
                            <gt>
                                <property>/engines/engine[0]/n2</property>
                                <value>88.5</value>
                            </gt>
                        </or>
                    </and>
                    <nq>
                        <property>fcs/canopy/serviceable</property>
                        <value>1</value>
                    </nq>
                    <nq>
                        <property>fcs/canopy/hinges/serviceable</property>
                        <value>1</value>
                    </nq>
                </or>
            </function>
        </fcs_function>
        
        <fcs_function name="systems/indicators/canopy-and-seat">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/indicators/canopy-and-seat-primary</property>
                            <value>1</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: TÄNDSYST (blinking)

          # manual says between 11-16% it goes on, so 16 is fine

        -->
        
        <fcs_function name="systems/indicators/ignition-system">
            <function>
                <and>
                    <or>
                        <and>
                            <eq>
                                <property>propulsion/engine/cutoff-low-pressure</property>
                                <value>0</value>
                            </eq>
                            <lt>
                                <property>propulsion/engine[0]/n2</property>
                                <value>50</value>
                            </lt>
                            <gt>
                                <property>propulsion/engine[0]/n2</property>
                                <value>16</value>
                            </gt>
                            <eq>
                                <property>/engines/engine/thrust_lb</property>
                                <value>0</value>
                            </eq>
                        </and>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: STARTSYST (steady)
        -->
        
        <fcs_function name="systems/indicators/start-system">
            <function>
                <or>
                    <and>
                        <eq>
                            <property>/controls/engines/engine[0]/starter-cmd</property>
                            <value>1</value>
                        </eq>
                        <lt>
                            <property>propulsion/engine[0]/n2</property>
                            <value>50</value>
                        </lt>
                        <eq>
                            <property>/engines/engine/thrust_lb</property>
                            <value>0</value>
                        </eq>
                    </and>
                    <property>/controls/lighting/test-indicator-panels</property>
                </or>
            </function>
        </fcs_function>


        <!-- Swedish: MAN BR REG (steady)
        -->
        
        <fcs_function name="systems/indicators/manual-fuel-regulation">
            <function>
                <or>
                    <lt>
                        <property>propulsion/engine[0]/n2</property>
                        <value>9</value>
                    </lt>
                    <eq>
                        <property>/controls/fuel/auto</property>
                        <value>0</value>
                    </eq>
                    <property>/controls/lighting/test-indicator-panels</property>
                </or>
            </function>
        </fcs_function>


        <!-- Swedish: CD (blinking)
        -->
        
        <fcs_function name="systems/indicators/central-cpu">
            <function>
                <and>
                    <property>/controls/lighting/test-indicator-panels</property>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: PRIMÄRDATA (blinking, supp )
        -->

        <fcs_function name="systems/indicators/primary-data-primary">
            <function>
                <eq>
                    <property>/instrumentation/head-up-display/serviceable</property>
                    <value>0</value>
                </eq>
            </function>
        </fcs_function>
        
        <fcs_function name="systems/indicators/primary-data">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>/ja37/avionics/primaryData</property><!-- involves timer when starting engine -->
                            <value>1</value>
                        </eq>
                        <eq>
                            <property>systems/indicators/primary-data-primary</property>
                            <value>1</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: TN (steady)
        -->
        
        <fcs_function name="systems/indicators/inertia-navigation">
            <function>
                <or>
                        <eq>
                            <property>/ja37/avionics/ins</property><!-- involves timer when starting engine -->
                            <value>0</value>
                        </eq>
                    <property>/controls/lighting/test-indicator-panels</property>
                </or>
            </function>
        </fcs_function>


        <!-- Swedish: RADAR (blinking, supp: el, cd, primär, hydr-1)
        -->
        
        <fcs_function name="systems/indicators/radar-secondary">
            <function>
                <or>
                    <lt>
                        <property>/ja37/elec/dc-bus-main-volt</property>
                        <value>20</value>
                    </lt>
                    <lt>
                        <property>/ja37/elec/ac-bus-secondary-volt</property>
                        <value>180</value>
                    </lt>
                    <nq>
                        <property>systems/hydraulics/system1/pressure</property>
                        <value>1</value>
                    </nq>
                </or>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/radar-primary">
            <function>
                <nq>
                    <property>/instrumentation/radar/serviceable</property>
                    <value>1</value>
                </nq>
            </function>
        </fcs_function>

        <switch name="systems/indicators/radar">
            <default value="systems/indicators/radar-secondary"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/radar-primary == 1
            </test>
        </switch>


        <!-- Swedish: IKS (steady)
        -->
        
        <fcs_function name="systems/indicators/transponder">
            <function>
                <or>
                    <lt>
                        <property>/systems/electrical/outputs/transponder</property>
                        <value>20</value>
                    </lt>
                    <property>/controls/lighting/test-indicator-panels</property>
                </or>
            </function>
        </fcs_function>


        <!-- Swedish: ALFA (blinking)
        -->
        
        <fcs_function name="systems/indicators/alpha">
            <function>
                <!--<or>
                <and>
                    <or>
                        <and>
                            <not>
                                <property>/gear/gear/position-norm</property>
                            </not>
                            <or>
                                <and>
                                    <greater-than>
                                        <property>/orientation/alpha-deg</property>
                                        <value>23</value>
                                    </greater-than>
                                    <less-than>
                                        <property>/instrumentation/altimeter/indicated-altitude-ft</property>
                                        <value>32808</value>
                                    </less-than>
                                </and>
                                <and>
                                    <greater-than>
                                        <property>/orientation/alpha-deg</property>
                                        <value>20</value>
                                    </greater-than>
                                    <greater-than>
                                        <property>/instrumentation/altimeter/indicated-altitude-ft</property>
                                        <value>32808</value>
                                    </greater-than>
                                </and>
                            </or>
                        </and>
                        <and>
                            <property>/gear/gear/position-norm</property>
                            <greater-than>
                                <property>/orientation/alpha-deg</property>
                                <value>18</value>
                            </greater-than>
                            <not>
                                <property>/gear/gear[1]/wow</property>
                            </not>
                            <not>
                                <property>/gear/gear[2]/wow</property>
                            </not>
                        </and>
                    </or>-->
                <and>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                    <property>/controls/lighting/test-indicator-panels</property>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: SYRGAS (blinking, sound)
        -->
        
        <fcs_function name="systems/indicators/oxygen-primary">
            <function>
                <or>
                    <eq>
                        <property>/controls/oxygen</property>
                        <value>0</value>
                    </eq>
                    <lt>
                        <property>/ja37/systems/oxygen-bottle-pressure</property>
                        <value>41</value><!-- 4Mpa (41 kp/cm2) -->
                    </lt>
                </or>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/oxygen">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/indicators/oxygen-primary</property>
                            <value>1</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: UTL TEMP (blinking, sound)
        -->
        
        <fcs_function name="systems/indicators/outlet-temperature-primary">
            <function>
                <gt>
                    <property>propulsion/engine/outlet-temperature-degc</property>
                    <value>890</value><!-- about 861 at mach 2 at 35000ft and 877 at mach 2.21 at 35000ft -->
                </gt>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/outlet-temperature">
            <function>
                <and>
                    <or>
                        <eq>
                            <property>systems/indicators/outlet-temperature-primary</property>
                            <value>1</value>
                        </eq>
                        <property>/controls/lighting/test-indicator-panels</property>
                    </or>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>


        <!-- Swedish: BRÄ MÄNGD (blinking, sound)
        -->

        <switch name="systems/indicators/low-fuel-primary">
            <default value="0"/>
            <test logic="AND" value="1">
                instruments/fuel/ratio lt 0.24
                gear/gear-pos-norm == 0
            </test>
        </switch>

        <fcs_function name="systems/indicators/low-fuel-secondary">
            <function>
                <lt>
                    <property>instruments/fuel/ratio</property>
                    <quotient>
                        <property>/ja37/systems/fuel-warning-extra-percent</property>
                        <value>100</value>
                    </quotient>
                </lt>
            </function>
        </fcs_function>

        <fcs_function name="systems/indicators/low-fuel">
            <function>
                <or>
                    <and>
                        <eq>
                            <property>systems/indicators/low-fuel-secondary</property>
                            <value>1</value>
                        </eq>
                        <eq>
                            <!-- delicate but works. If master-warning has been acknowledged this warning goes away -->
                            <property>systems/indicators/master-warning/fuel-low-2</property>
                            <value>3</value>
                        </eq>
                    </and>
                    <and>
                        <or>
                            <eq>
                                <property>systems/indicators/low-fuel-primary</property>
                                <value>1</value>
                            </eq>
                            <property>/controls/lighting/test-indicator-panels</property>
                        </or>
                        <eq>
                            <property>/ja37/blink/four-Hz/state</property>
                            <value>1</value>
                        </eq>
                    </and>
                </or>
            </function>
        </fcs_function>


        <!-- Swedish: ANP 37 (blinking)

        TODO: Make weapons depend properly on voltage.

        -->
        
        <fcs_function name="systems/indicators/weapons">
            <function>
                <and>
                    <property>/controls/lighting/test-indicator-panels</property>
                    <eq>
                        <property>/ja37/blink/four-Hz/state</property>
                        <value>1</value>
                    </eq>
                </and>
            </function>
        </fcs_function>

    </channel>









    <channel execrate="4" name="Misc indicator lights logic">

        <switch name="systems/indicators/dc-light-tenHz">
            <default value="0"/>
            <test logic="AND" value="/systems/electrical/dc-light">               
                /ja37/blink/four-Hz/state == 1
            </test>
        </switch>

        <switch name="systems/indicators/dc-light-fiveHz">
            <default value="0"/>
            <test logic="AND" value="/systems/electrical/dc-light">               
                /ja37/blink/five-Hz/state == 1
            </test>
        </switch>

        <switch name="systems/indicators/dc-light-twoHz">
            <default value="0"/>
            <test logic="AND" value="/systems/electrical/dc-light">               
                /ja37/blink/two-Hz/state == 1
            </test>
        </switch>

        <!-- Swedish: REV AVDR / TRANSONIC (white)

            Indicator: Dangerous low speed for reverse OR in transonic regime

        -->

        <fcs_function name="systems/indicators/transonic">
            <function>
                <and>
                    <gt>
                        <property>/instrumentation/airspeed-indicator/indicated-mach</property>
                        <value>0.97</value>
                    </gt>
                    <lt>
                        <property>/instrumentation/airspeed-indicator/indicated-mach</property>
                        <value>1.05</value>
                    </lt>
                </and>
            </function>
        </fcs_function>
        
        <!-- sample is 2 secs -->
        <!--<switch name="systems/indicators/transonic-aural-starttime">
            <default value="sim-time-sec"/>
            <test logic="AND" value="systems/indicators/transonic-aural-starttime">
                systems/indicators/transonic == 1
            </test>
        </switch>

        <fcs_function name="systems/indicators/transonic-aural-stoptime">
            <function>
                <sum>
                    <p>systems/indicators/transonic-aural-starttime</p>
                    <v>2.1</v>
                </sum>
            </function>
        </fcs_function>
        
        <switch name="systems/indicators/transonic-aural">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/indicators/transonic-aural-stoptime gt sim-time-sec
                systems/indicators/transonic-aural-starttime lt sim-time-sec
            </test>
        </switch>-->

        <fcs_function name="systems/indicators/transonic-warning">
            <function>
                <or>
                    <eq>
                        <property>systems/indicators/transonic</property>
                        <value>1</value>
                    </eq>
                    <and>
                        <eq>
                            <property>/engines/engine/is-reversed</property>
                            <value>1</value>
                        </eq>
                        <lt>
                            <property>/instrumentation/airspeed-indicator/indicated-speed-kt</property>
                            <value>64.8</value>
                        </lt>
                    </and>
                </or>
            </function>
        </fcs_function>

        <switch name="/instrumentation/transonic-indicator">
            <default value="0"/>
            <test logic="OR" value="/systems/electrical/dc-light">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/transonic-warning == 1
            </test>
        </switch>

        <!-- Swedish: REV (green)

            Indicator: Engine is reversed

        -->

        <switch name="/instrumentation/reverse-indicator">
            <default value="0"/>
            <test logic="OR" value="/systems/electrical/dc-light">
                /controls/lighting/test-indicator-panels == 1
                /controls/engines/engine[0]/reverser-cmd == 1
            </test>
        </switch>

        <switch name="propulsion/engine/cutoff-indicator">
            <default value="0"/>
            <test logic="OR" value="/systems/electrical/dc-light">
                /controls/lighting/test-indicator-panels == 1
                propulsion/engine/cutoff-low-pressure == 1
                /controls/engines/engine[0]/cutoff-augmentation == 1
            </test>
        </switch>

        <switch name="/ja37/avionics/roll-trim-centered">
            <default value="0"/>
            <test logic="OR" value="/systems/electrical/dc-light">
                /controls/lighting/test-indicator-panels == 1
            </test>
            <test logic="AND" value="/systems/electrical/dc-light">
                /controls/flight/aileron-trim lt 0.025
                /controls/flight/aileron-trim gt -0.025
            </test>
        </switch>
        
        <switch name="/ja37/avionics/yaw-trim-centered">
            <default value="0"/>
            <test logic="OR" value="/systems/electrical/dc-light">
                /controls/lighting/test-indicator-panels == 1
            </test>
            <test logic="AND" value="/systems/electrical/dc-light">
                /controls/flight/rudder-trim lt 0.025
                /controls/flight/rudder-trim gt -0.025
            </test>
        </switch>
        

        <switch name="systems/electrical/battery-charging-test">
            <description>
                      Converted DC digital

                      Used for translating texture on indicator lamp
            </description>
            <default value="0"/>
            <test logic="OR" value="1">
                systems/electrical/battery-charging-norm == 1
                /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>

        <switch name="/instrumentation/battery-indicator">
            <default value="systems/electrical/battery-charging-norm"/>
            <test logic="OR" value="/systems/electrical/dc-light">
                /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>

        <switch name="/instrumentation/external-indicator">
            <default value="systems/electrical/external/available"/>
            <test logic="OR" value="/systems/electrical/dc-light">
                /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>

        <switch name="/ja37/avionics/reservkurs-indicator">
            <default value="0"/>
            <test logic="OR" value="/systems/electrical/dc-light">
                /controls/lighting/test-indicator-panels == 1
                /ja37/avionics/reservkurs == 1
            </test>
        </switch>

        <fcs_function name="systems/indicators/time-till-crash">
            <function>
                <quotient>
                    <property>/position/altitude-agl-ft</property>
                    <property>/velocities/speed-down-fps</property>
                </quotient>
            </function>
        </fcs_function>        

        <switch name="/ja37/sound/terrain-on">
            <default value="0"/>
            <test logic="AND" value="0">
                /ja37/hud/current-mode == 0 <!-- equals takeoff -->
            </test>
            <test logic="AND" value="1">
                gear/gear-pos-norm == 1 <!-- equals landing -->
                /position/altitude-agl-ft gt 164
                systems/indicators/time-till-crash lt 10
                systems/indicators/time-till-crash gt 0
                /controls/altimeter-radar == 1
                /ja37/supported/picking == 0
            </test>
            <test logic="AND" value="1">
                gear/gear-pos-norm ne 1 <!-- not equals landing -->
                systems/indicators/time-till-crash lt 10
                systems/indicators/time-till-crash gt 0
                /controls/altimeter-radar == 1
                /ja37/supported/picking == 0
            </test>
            <test logic="AND" value="1">
                gear/gear-pos-norm == 1 <!-- equals landing -->
                /position/altitude-agl-ft gt 164
                /ja37/radar/time-till-crash lt 10
                /ja37/radar/time-till-crash gt 0
                /controls/altimeter-radar == 1
                /ja37/supported/picking == 1
            </test>
            <test logic="AND" value="1">
                gear/gear-pos-norm ne 1
                /ja37/hud/current-mode ne 3 <!-- not equals landing -->
                /ja37/radar/time-till-crash lt 10
                /ja37/radar/time-till-crash gt 0
                /controls/altimeter-radar == 1
                /ja37/supported/picking == 1
            </test>
        </switch>

        <switch name="/instrumentation/terrain-warning-steady-time">
            <default value="sim-time-sec"/>
            <test logic="OR" value="/instrumentation/terrain-warning-steady-time">
                /ja37/sound/terrain-on == 0
            </test>
        </switch>

        <fcs_function name="/instrumentation/terrain-warning-steady">
            <function>
                <sum>
                    <p>/instrumentation/terrain-warning-steady-time</p>
                    <v>3</v>
                </sum>
            </function>
        </fcs_function>
        
        <fcs_function name="/instrumentation/terrain-warning-steady-10">
            <function>
                <sum>
                    <p>/instrumentation/terrain-warning-steady-time</p>
                    <v>10</v>
                </sum>
            </function>
        </fcs_function>

        <fcs_function name="/instrumentation/terrain-warning-hold">
            <function>
                <or>
                    <and>
                        <eq>
                            <property>autoflight/mode</property>
                            <v>3</v>
                        </eq>
                        <lt>
                            <quotient>
                                <property>/instrumentation/altimeter/indicated-altitude-ft</property>
                                <property>autoflight/pitch/alt/target</property>
                            </quotient>
                            <v>0.8</v>
                        </lt>
                    </and>
                    <p>systems/indicators/flashing-mkv</p>
                </or>
            </function>
        </fcs_function>
        
        <!--
            TODO: SPAK mode + DCloss > 6 secs = flashing alt bars in HUD and MI
            TODO: HÖJD/ATT mode + DCloss > 6 secs = flashing alt bars in HUD and MI and flashing ground collision red light on MI.

        -->
        
        <fcs_function name="systems/indicators/flashing-alt-bars">
            <function>
                <!-- authentic warnings -->
                <and>
                    <eq>
                        <property>autoflight/mode</property>
                        <value>1</value>
                    </eq>
                    <gt>
                        <property>/ja37/avionics/lost-dc-sec</property>
                        <value>6</value>
                    </gt>
                </and>
            </function>
        </fcs_function>
        
        <fcs_function name="systems/indicators/flashing-mkv">
            <function>
                <!-- authentic warnings -->
                <and>
                    <gt>
                        <property>autoflight/mode</property>
                        <value>1</value>
                    </gt>
                    <gt>
                        <property>/ja37/avionics/lost-dc-sec</property>
                        <value>6</value>
                    </gt>
                </and>
            </function>
        </fcs_function>

        <switch name="/instrumentation/terrain-warning-secondary">
            <default value="0"/>
            <test logic="AND" value="1">
                /instrumentation/terrain-warning-hold == 1
            </test>
        </switch>

        <switch name="/instrumentation/terrain-warning">
            <default value="0"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /ja37/sound/terrain-on == 1
            </test>
            <test logic="AND" value="1">
                /instrumentation/terrain-warning-steady gt sim-time-sec
            </test>
        </switch>
        
        <switch name="/instrumentation/terrain-override">
            <default value="0"/>
            <test logic="OR" value="1">
                /ja37/sound/terrain-on == 1
                /instrumentation/terrain-warning-steady-10 gt sim-time-sec
            </test>
        </switch>

        <switch name="/instrumentation/terrain-warning-test">
            <default value="0"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>

        <switch name="/instrumentation/terrain-warning-light">
            <default value="0"/>
            <test logic="OR" value="/systems/electrical/dc-light">
                /instrumentation/terrain-warning == 1
                /instrumentation/terrain-warning-test == 1
            </test>
            <test logic="OR" value="/systems/electrical/dc-light">
                /instrumentation/terrain-warning-secondary == 1
            </test>
        </switch>
        
        <switch name="/instrumentation/TLS-light-steady-time">
            <default value="sim-time-sec"/>
            <test logic="AND" value="/instrumentation/TLS-light-steady-time">
                /ja37/hud/TILS-on == 0
                /instrumentation/nav[0]/has-gs == 1
            </test>
        </switch>

        <fcs_function name="/instrumentation/TLS-light-steady-hyst">
            <function>
                <sum>
                    <p>/instrumentation/TLS-light-steady-time</p>
                    <v>7</v>
                </sum>
            </function>
        </fcs_function>
        
        <switch name="/instrumentation/TLS-light-blink-time">
            <default value="sim-time-sec"/>
            <test logic="OR" value="/instrumentation/TLS-light-blink-time">
                /ja37/hud/TILS-on == 0
            </test>
        </switch>

        <fcs_function name="/instrumentation/TLS-light-blink-hyst">
            <function>
                <sum>
                    <p>/instrumentation/TLS-light-blink-time</p>
                    <v>7</v>
                </sum>
            </function>
        </fcs_function>
        
        <switch name="/instrumentation/TLS-light-steady">
            <default value="0"/>
            <test logic="AND" value="1">
                /ja37/hud/TILS-on == 1
                /instrumentation/nav[0]/gs-in-range == 1
                /instrumentation/nav[0]/has-gs == 1
            </test>
            <test logic="AND" value="0">
                /instrumentation/TLS-light-steady-hyst lt sim-time-sec
            </test>
            <test logic="AND" value="1">
                /instrumentation/TLS-light-steady-hyst gt sim-time-sec
                /instrumentation/TLS-light-steady == 1
            </test>
        </switch>
        
        <switch name="/instrumentation/TLS-light-blink">
            <default value="0"/>
            <test logic="OR" value="1">
                /ja37/hud/TILS-on == 1
            </test>
            <test logic="AND" value="0">
                /instrumentation/TLS-light-blink-hyst lt sim-time-sec
            </test>
            <test logic="AND" value="1">
                /instrumentation/TLS-light-blink-hyst gt sim-time-sec
                /instrumentation/TLS-light-blink == 1
            </test>
        </switch>
        
        <switch name="/instrumentation/TLS-light">
            <default value="/instrumentation/TLS-light-steady"/>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /instrumentation/TLS-light-blink == 1
                /controls/lighting/test-indicator-panels == 1
            </test>
        </switch>
        
    </channel>    






    <channel execrate="4" name="Test indicator lights logic">

        <switch name="/ja37/test/button-ym-tp">
            <default value="0"/>
            <test logic="OR" value="systems/indicators/dc-light-twoHz">               
                /controls/lighting/test-indicator-panels == 1
                /ja37/test/ym-flash == 1
            </test>
            <test logic="AND" value="/systems/electrical/dc-light">
                /ja37/test/ym-steady == 1
            </test>
        </switch>

        <switch name="/ja37/test/button-start-tp">
            <default value="0"/>
            <test logic="OR" value="systems/indicators/dc-light-twoHz">               
                /controls/lighting/test-indicator-panels == 1
                /ja37/test/start-flash == 1
            </test>
            <test logic="AND" value="/systems/electrical/dc-light">
                /ja37/test/start-steady == 1
            </test>
        </switch>

        <switch name="/ja37/test/button-rep-tp">
            <default value="0"/>
            <test logic="OR" value="systems/indicators/dc-light-twoHz">               
                /controls/lighting/test-indicator-panels == 1
                /ja37/test/rep-flash == 1
            </test>
            <test logic="AND" value="/systems/electrical/dc-light">
                /ja37/test/rep-steady == 1
            </test>
        </switch>

        <switch name="/ja37/test/button-ipk-tp">
            <default value="0"/>
            <test logic="OR" value="systems/indicators/dc-light-twoHz">               
                /controls/lighting/test-indicator-panels == 1
                /ja37/test/ipk-flash == 1
            </test>
            <test logic="AND" value="/systems/electrical/dc-light">
                /ja37/test/ipk-steady == 1
            </test>
        </switch>

        <switch name="/ja37/test/button-fk-tp">
            <default value="0"/>
            <test logic="OR" value="systems/indicators/dc-light-twoHz">               
                /controls/lighting/test-indicator-panels == 1
                /ja37/test/fk-flash == 1
            </test>
            <test logic="AND" value="/systems/electrical/dc-light">
                /ja37/test/fk-steady == 1
            </test>
        </switch>

        <switch name="/ja37/test/button-fel-tp">
            <default value="0"/>
            <test logic="OR" value="systems/indicators/dc-light-twoHz">               
                /controls/lighting/test-indicator-panels == 1
                /ja37/test/fel-flash == 1
            </test>
            <test logic="AND" value="/systems/electrical/dc-light">
                /ja37/test/fel-steady == 1
            </test>
        </switch>

    </channel>











    <channel execrate="4" name="Master warning logic">

        <!--                                         
            no sound, just blinking master lights:
                electrical
                el-reserve
                canopy
                cabin-alt
                (ignition)
                no reverse
                stuck in forward
                fuel distr
                tank pump
                radar
                primary data
                (computer)
                hydr-2
                hydr-reverse
                (alpha)
            sound and blinking master lights:
                stick
                att
                alt
                pitch gearing
                (fire)
                (fire in starter)
                outlet temp
                hydr-1
                auto-throttle blinking
                oxygen
                gears blinking
                oil pressure
                (fuel amount) has own sound, so set to no master sound
                exceed max airspeed (whatever that is)
                engine not running when airborne
        -->

        <switch name="systems/indicators/master-warning/fire">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/fire-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/fire == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/fire gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/fire-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/engine-off">
            <default value="0"/>
            <test logic="OR" value="0">
                /engines/engine/running == 1
                gear/unit[0]/WOW == 1
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/engine-off == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/engine-off gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                /engines/engine/running == 0
                gear/unit[0]/WOW == 0
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/canopy-alert">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/canopy-and-seat-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/canopy-alert == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/canopy-alert gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/canopy-and-seat-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/electrical-problem">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/electrical-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/electrical-problem == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/electrical-problem gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/electrical-primary == 1
            </test>
        </switch>        

        <switch name="systems/indicators/master-warning/electrical-reserve-problem">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/electrical-reserve-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/electrical-reserve-problem == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/electrical-reserve-problem gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/electrical-reserve-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/hydr-1-low">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/hydraulics/system1/pressure == 1
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/hydr-1-low == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/hydr-1-low gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/hydraulics/system1/pressure == 0
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/hydr-2-low">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/hydraulics/system2/pressure-main == 1
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/hydr-2-low == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/hydr-2-low gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/hydraulics/system2/pressure-main == 0
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/hydr-reserve-low">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/hydraulics/system2/pressure-reserve == 1
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/hydr-reserve-low == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/hydr-reserve-low gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/hydraulics/system2/pressure-reserve == 0
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/cabin-pressure-low">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/cabin-pressure-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/cabin-pressure-low == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/cabin-pressure-low gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/cabin-pressure-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/stuck-in-forward">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/forward-thrust-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/stuck-in-forward == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/stuck-in-forward gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/forward-thrust-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/no-reverse">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/no-reverse-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/no-reverse == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/no-reverse gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/no-reverse-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/fuel-distr-problem">
            <default value="0"/>
            <test logic="AND" value="0">
                systems/indicators/fuel-flow-primary == 0
                sim-time-sec le systems/indicators/fuel-flow-primary-2-time-blinking
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/fuel-distr-problem == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/fuel-distr-problem gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="OR" value="2">
                systems/indicators/fuel-flow-primary == 1
                sim-time-sec gt systems/indicators/fuel-flow-primary-2-time-blinking
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/fuel-pump-problem">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/fuel-pump-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/fuel-pump-problem == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/fuel-pump-problem gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/fuel-pump-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/radar-problem">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/radar-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/radar-problem == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/radar-problem gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/radar-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/data-problem">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/primary-data-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/data-problem == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/data-problem gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/primary-data-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/gears-problem">
            <default value="0"/>
            <test logic="AND" value="0">
                systems/indicators/gears-primary == 0
                sim-time-sec le systems/indicators/gears-time-blinking
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/gears-problem == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/gears-problem gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="OR" value="3">
                systems/indicators/gears-primary == 1
                sim-time-sec gt systems/indicators/gears-time-blinking
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/oil-pressure-low">
            <default value="0"/>
            <test logic="AND" value="0">
                systems/indicators/oil-pressure-primary == 0
                systems/indicators/oil-pressure-secondary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/oil-pressure-low == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/oil-pressure-low gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/oil-pressure-primary == 1
            </test>
            <test logic="AND" value="2">
                systems/indicators/oil-pressure-secondary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/oxygen-low">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/oxygen-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/oxygen-low == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/oxygen-low gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/oxygen-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/outlet-temp-high">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/outlet-temperature-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/outlet-temp-high == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/outlet-temp-high gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/outlet-temperature-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/elevator-gearing">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/pitch-gearing-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/elevator-gearing == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/elevator-gearing gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/pitch-gearing-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/auto-throttle-issue">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/auto-throttle-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/auto-throttle-issue == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/auto-throttle-issue gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/auto-throttle-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/auto-att-issue">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/auto-attitude-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/auto-att-issue == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/auto-att-issue gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/auto-attitude-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/auto-alt-issue">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/auto-altitude-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/auto-alt-issue == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/auto-alt-issue gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/auto-altitude-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/stick-problem">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/flightstick-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/stick-problem == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/stick-problem gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/flightstick-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/fuel-low">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/low-fuel-primary == 0
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/fuel-low == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/fuel-low gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/low-fuel-primary == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/fuel-low-2-changed">
            <default value="0"/>
            <test logic="OR" value="1">
                /ja37/systems/fuel-warning-extra-percent ne systems/indicators/master-warning/fuel-low2-old
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/fuel-low2-old">
            <default value="/ja37/systems/fuel-warning-extra-percent"/>
            <test logic="OR" value="0">
                /ja37/systems/fuel-warning-extra-percent == -2 <!-- will never happen -->
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/fuel-low-2">
            <default value="0"/>
            <test logic="OR" value="0">
                systems/indicators/low-fuel-secondary == 0
                systems/indicators/master-warning/fuel-low-2-changed == 1
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/fuel-low-2 == 1
            </test>
            <test logic="AND" value="1">
                systems/indicators/master-warning/fuel-low-2 gt 1
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/low-fuel-secondary == 1
            </test>
        </switch>
        
        <switch name="systems/indicators/master-warning/ap-downgrade">
            <default value="0"/>
            <test logic="OR" value="0">
                /ja37/avionics/master-warning-button == 1
            </test>
            <test logic="AND" value="3">
                systems/indicators/master-warning/ap-downgrade == 3                
            </test>
            <test logic="AND" value="3">
                autoflight/mode lt autoflight/mode-last
            </test>
        </switch>
        
        <pure_gain name="autoflight/mode-last">
            <input>autoflight/mode</input>
            <gain>1.0</gain>
        </pure_gain>

        <switch name="systems/indicators/master-warning/engine-startup">
            <description>
                            Engine is starting up

                            Maybe make more detailed check in future.
            </description>
            <default value="0"/>
            <test logic="OR" value="1">
                systems/electrical/starter-relay-R1 == 1
                /controls/engines/engine[0]/starter-cmd == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/warning">
            <default value="0"/>
            <test logic="AND" value="0">
                systems/indicators/master-warning/engine-startup == 1
            </test>
            <test logic="OR" value="3">
                systems/indicators/master-warning/engine-off gt 2
                systems/indicators/master-warning/electrical-problem gt 2
                systems/indicators/master-warning/electrical-reserve-problem gt 2
                systems/indicators/master-warning/canopy-alert gt 2
                systems/indicators/master-warning/hydr-1-low gt 2
                systems/indicators/master-warning/hydr-2-low gt 2
                systems/indicators/master-warning/hydr-reserve-low gt 2
                systems/indicators/master-warning/cabin-pressure-low gt 2
                systems/indicators/master-warning/stuck-in-forward gt 2
                systems/indicators/master-warning/no-reverse gt 2
                systems/indicators/master-warning/fuel-distr-problem gt 2
                systems/indicators/master-warning/fuel-pump-problem gt 2
                systems/indicators/master-warning/radar-problem gt 2
                systems/indicators/master-warning/data-problem gt 2
                systems/indicators/master-warning/elevator-gearing gt 2
                systems/indicators/master-warning/outlet-temp-high gt 2
                systems/indicators/master-warning/oxygen-low gt 2
                systems/indicators/master-warning/oil-pressure-low gt 2
                systems/indicators/master-warning/gears-problem gt 2
                systems/indicators/master-warning/auto-throttle-issue gt 2
                systems/indicators/master-warning/auto-att-issue gt 2
                systems/indicators/master-warning/auto-alt-issue gt 2
                systems/indicators/master-warning/stick-problem gt 2
                systems/indicators/master-warning/fuel-low gt 2
                systems/indicators/master-warning/fuel-low-2 gt 2
                systems/indicators/master-warning/fire gt 2
                systems/indicators/master-warning/ap-downgrade gt 2
            </test>
            <test logic="OR" value="2">
                systems/indicators/master-warning/engine-off gt 1
                systems/indicators/master-warning/electrical-problem gt 1
                systems/indicators/master-warning/electrical-reserve-problem gt 1
                systems/indicators/master-warning/canopy-alert gt 1
                systems/indicators/master-warning/hydr-1-low gt 1
                systems/indicators/master-warning/hydr-2-low gt 1
                systems/indicators/master-warning/hydr-reserve-low gt 1
                systems/indicators/master-warning/cabin-pressure-low gt 1
                systems/indicators/master-warning/stuck-in-forward gt 1
                systems/indicators/master-warning/no-reverse gt 1
                systems/indicators/master-warning/fuel-distr-problem gt 1
                systems/indicators/master-warning/fuel-pump-problem gt 1
                systems/indicators/master-warning/radar-problem gt 1
                systems/indicators/master-warning/data-problem gt 1
                systems/indicators/master-warning/elevator-gearing gt 1
                systems/indicators/master-warning/outlet-temp-high gt 1
                systems/indicators/master-warning/oxygen-low gt 1
                systems/indicators/master-warning/oil-pressure-low gt 1
                systems/indicators/master-warning/gears-problem gt 1
                systems/indicators/master-warning/auto-throttle-issue gt 1
                systems/indicators/master-warning/auto-att-issue gt 1
                systems/indicators/master-warning/auto-alt-issue gt 1
                systems/indicators/master-warning/stick-problem gt 1
                systems/indicators/master-warning/fuel-low gt 1
                systems/indicators/master-warning/fuel-low-2 gt 1
                systems/indicators/master-warning/fire gt 1
                systems/indicators/master-warning/ap-downgrade gt 1
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/engine-off gt 0
                systems/indicators/master-warning/electrical-problem gt 0
                systems/indicators/master-warning/electrical-reserve-problem gt 0
                systems/indicators/master-warning/canopy-alert gt 0
                systems/indicators/master-warning/hydr-1-low gt 0
                systems/indicators/master-warning/hydr-2-low gt 0
                systems/indicators/master-warning/hydr-reserve-low gt 0
                systems/indicators/master-warning/cabin-pressure-low gt 0
                systems/indicators/master-warning/stuck-in-forward gt 0
                systems/indicators/master-warning/no-reverse gt 0
                systems/indicators/master-warning/fuel-distr-problem gt 0
                systems/indicators/master-warning/fuel-pump-problem gt 0
                systems/indicators/master-warning/radar-problem gt 0
                systems/indicators/master-warning/data-problem gt 0
                systems/indicators/master-warning/elevator-gearing gt 0
                systems/indicators/master-warning/outlet-temp-high gt 0
                systems/indicators/master-warning/oxygen-low gt 0
                systems/indicators/master-warning/oil-pressure-low gt 0
                systems/indicators/master-warning/gears-problem gt 0
                systems/indicators/master-warning/auto-throttle-issue gt 0
                systems/indicators/master-warning/auto-att-issue gt 0
                systems/indicators/master-warning/auto-alt-issue gt 0
                systems/indicators/master-warning/stick-problem gt 0
                systems/indicators/master-warning/fuel-low gt 0
                <!--systems/indicators/master-warning/fuel-low-2 gt 0-->
                systems/indicators/master-warning/fire gt 0
                systems/indicators/master-warning/ap-downgrade gt 0
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/lamp1">
            <default value="0"/>
            <test logic="OR" value="0">
                /ja37/elec/dc-bus-main-volt lt 20
            </test>
            <test logic="OR" value="/ja37/blink/four-Hz/state">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/master-warning/warning gt 1
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/warning == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/tenHz-opposite">
            <default value="0"/>
            <test logic="OR" value="1">
                /ja37/blink/four-Hz/state == 0
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/lamp2">
            <default value="0"/>
            <test logic="OR" value="0">
                /ja37/elec/dc-bus-main-volt lt 20
            </test>
            <test logic="OR" value="systems/indicators/master-warning/tenHz-opposite">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/master-warning/warning gt 1
            </test>
            <test logic="OR" value="1">
                systems/indicators/master-warning/warning == 1
            </test>
        </switch>

        <switch name="systems/indicators/master-warning/audio">
            <default value="0"/>
            <test logic="OR" value="1">
                /controls/lighting/test-indicator-panels == 1
                systems/indicators/master-warning/warning == 3
            </test>
        </switch>

    </channel>

</system>
